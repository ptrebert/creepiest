[Run]
load_path= /home/pebert/work/code/mpggit/creepiest/pipelines
load_name= preprocess.ppl_prep_encode

[Pipeline]
name= PREPENCODE
refdir= /TL/deep/fhgfs/projects/pebert/thesis/refdata/chromsizes
gendir= /TL/deep/fhgfs/projects/pebert/thesis/refdata/genomes
datadir= /TL/deep/fhgfs/projects/pebert/thesis/biodata/dlfolder/encode
tempdir= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encode
outdir= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encode/hdf5
encmd= /home/pebert/work/code/mpggit/creepiest/datasrc/encode/encode_metadata_ro.tsv

convbw= bigWigToBedGraph {inputfile} stdout | egrep "^chr[0-9]+\s" | gzip > {outputfile}
convbg= creepiest.py -dmp ${EnvPaths:confdump}/convert -wrk 4 convert --task signal -i {{inputfiles}} -o {{outputfile}} -cs {{referencefile}} -og {ASSEMBLY[0]}/signal/cov/src


convbb= bigBedToBed {inputfile} stdout | egrep "^chr[0-9]+\s" | gzip -c > {outputfile}
convbed= creepiest.py -dmp ${EnvPaths:confdump}/convert -wrk 1 convert --filter-size 150 --task region -i {{inputfiles}} -o {{outputfile}} --score-idx 6 -og {ASSEMBLY[0]}/peak/src/fg
matchbed= creepiest.py -dmp ${EnvPaths:confdump}/match -wrk 8 match --seq-file ${gendir}/{ASSEMBLY[0]}.2bit
 --relax-init 1 --relax-step 0.5 --relax-limit 2.5 --timeout 15 --features len gc rep --allow-nomatch
 --input {{inputfile}} --input-group {ASSEMBLY[0]}/peak/src/fg --output {{outputfile}} --output-group {ASSEMBLY[0]}/peak/src/bg
runall= touch {outputfile}


[Ruffus]
use_threads= True
jobs= 30
verbose= 4
history_file= ${EnvPaths:ruffushist}/${Pipeline:name}_hist.sqlite
log_file= ${EnvPaths:ruffuslog}/${Pipeline:name}_ruffus.log

[JobConfig]
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=5G,slots_free=1,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 0

[MemJobConfig]
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=30G,slots_free=4,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 0

[ParallelJobConfig]
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=10G,slots_free=8,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 0
