[Run]
load_path= /home/pebert/work/code/mpggit/creepiest/pipelines
load_name= preprocess.ppl_prep_encexp
mkdir= ${Pipeline:tempdir}

[Pipeline]
name= PREPENCEXP
jobname= PREPEXP
datadir= /TL/deep/fhgfs/projects/pebert/thesis/biodata/dlfolder/encode
refdir= /TL/deep/fhgfs/projects/pebert/thesis/refdata/genemodel
tempdir= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encexp
tmpquant= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encexp/tmp
bedout= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encexp/bed
hdfout= /TL/deep/fhgfs/projects/pebert/thesis/biodata/pipelined/conversion/encexp/hdf5
encmd= /home/pebert/work/code/mpggit/creepiest/datasrc/encode/20160525_ENCODE_metadata_merged.tsv
bammd= /home/pebert/work/code/mpggit/creepiest/datasrc/encode/20160607_mm9_expression_BAM.tsv

whitemm9= ${refdir}/gencode_vM1_mm9_pctranscripts_white.gtf
blackmm9= ${refdir}/gencode_vM1_mm9_pctranscripts_black.gtf
refmm9= /TL/deep/fhgfs/projects/pebert/thesis/refdata/genomes/mm9.fa

convdump= creepiest.py -dmp ${EnvPaths:confdump}/convert -wrk 1 convert --task region -i {{inputfile}} -o {{outputfile}} --name-idx 3 -og gencode/{GENCVER[0]}/pcgenes/{REGTYPE[0]}
salmonidx= salmon index --kmerLen 21 --transcripts <(gunzip -c {{inputfile}}) --threads 16 --index ${refdir}/{TRANSCRIPTOME[0]}.idx --type quasi
musquant= salmon quant --index ${refdir}/gencode.vM1.pc_transcripts.idx --threads 16 --libType U --unmatedReads <(gunzip -c {{inputfiles}}) --biasCorrect
 --output ${tmpquant}/{ENCEXP[0]} --forgettingFactor 0.8 --useVBOpt
convbedexp= creepiest.py -dmp ${EnvPaths:confdump}/convert -wrk 1 convert --task region -i {{inputfile}} -o {{outputfile}} --use-header -og gencode/{GENCVER[0]}/pcgenes --name-idx 3
runall= touch {outputfile}


[Ruffus]
use_threads= True
jobs= 30
verbose= 4
history_file= ${EnvPaths:ruffushist}/${Pipeline:name}_hist.sqlite
log_file= ${EnvPaths:ruffuslog}/${Pipeline:name}_ruffus.log

[JobConfig]
jobname= ${Pipeline:jobname}
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=5G,slots_free=1,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 0

[MemJobConfig]
jobname= ${Pipeline:jobname}
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=30G,slots_free=4,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 0

[ParallelJobConfig]
jobname= ${Pipeline:jobname}
workdir= ${EnvPaths:workdir}
outpath= ${EnvPaths:ruffusdump}
errpath= ${EnvPaths:ruffusdump}
native_spec= -l mem_free=10G,slots_free=16,tmp_free=5G,h=deep1[0123456789]*|deep2[0123456789]*
scriptdir= ${EnvPaths:ruffusdump}
keepscripts= 1
